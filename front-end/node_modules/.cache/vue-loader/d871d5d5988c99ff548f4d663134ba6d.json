{"remainingRequest":"D:\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\front-end\\src\\views\\counseling\\MyReservation.vue?vue&type=style&index=0&id=3e69e710&lang=less&scoped=true&","dependencies":[{"path":"D:\\front-end\\src\\views\\counseling\\MyReservation.vue","mtime":1577053940723},{"path":"D:\\front-end\\node_modules\\css-loader\\index.js","mtime":1573722966629},{"path":"D:\\front-end\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1573725517685},{"path":"D:\\front-end\\node_modules\\postcss-loader\\src\\index.js","mtime":1573722998988},{"path":"D:\\front-end\\node_modules\\less-loader\\dist\\cjs.js","mtime":1573723014394},{"path":"D:\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1573722996621},{"path":"D:\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1573725517685}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@import '~ant-design-vue/lib/style/themes/default.less';\n.button-group {\n  margin-bottom: 1rem;\n  .button {\n    margin-left: 0.5rem;\n    margin-left: 0.5rem;\n  }\n}\n",{"version":3,"sources":["MyReservation.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MyReservation.vue","sourceRoot":"src/views/counseling","sourcesContent":["<template>\n  <page-view title=\"我的预约\">\n    <a-card>\n      <template>\n        <a-table :columns=\"columns\" :dataSource=\"rDataShow\" rowKey=\"id\" bordered>\n          <template\n              v-for=\"col in ['teacher', 'time', 'address']\"\n              :slot=\"col\"\n              slot-scope=\"text\"\n            >\n            <div :key=\"col\">{{ text }}</div>\n          </template>\n          <template slot=\"operation\" slot-scope=\"text, record\">\n            <a-button\n              size=\"small\"\n              type=\"danger\"\n              :hidden='text'\n              @click=\"onClickDelete(record.reservation.id)\"\n            >取消预约\n            </a-button>\n            <a-modal\n              title=\"确认取消\"\n              v-model=\"visible2\"\n              @ok=\"onClickDeleteRow\"\n            >\n              <div class=\"modal\">\n                是否取消本次预约\n              </div>\n            </a-modal>\n          </template>\n        </a-table>\n        <div style=\"margin-top:20px\">\n          <a-pagination @change=\"onChange\" :current=\"current\" :total=\"totalPage*10\" />\n        </div>\n      </template>\n    </a-card>\n  </page-view>\n</template>\n\n\n<script>\nimport Fuse from 'fuse.js'\nimport Vue from 'vue'\nimport { getMyReserve, cancelAppointment } from '@/api/counseling'\nimport Lightbox from 'vue-easy-lightbox'\nimport { PageView } from '@/layouts'\nVue.use(Lightbox)\n\nconst columns = [\n  {\n    title: '老师姓名',\n    dataIndex: 'teacher',\n   //width: '15%',\n    align: 'center',\n    scopedSlots: { customRender: 'teacher' },\n  },\n  {\n    title: '预约时间',\n    dataIndex: 'time',\n    align: 'center',\n    width: '18%',\n    scopedSlots: { customRender: 'time' },\n    sorter: (a, b) => a.reserveTime > b.reserveTime\n  },\n  {\n    title: '预约地址',\n    dataIndex: 'address',\n    align: 'center',\n    width: '30%',\n    scopedSlots: { customRender: 'address' }\n  },\n  {\n    titile: '操作',\n    align: 'center',\n    dataIndex: 'operation',\n    scopedSlots: { customRender: 'operation' }\n  },\n]\n\nconst rData=[]\nconst rDataShow=[]\n\nexport default {\n  name: 'myReservation',\n  inject: ['reload'],\n  components: {\n    PageView\n  },\n  data() {\n     return {\n        rData,\n        rDataShow,\n        deleteInfo:'',\n        columns,\n        current: 1,\n        totalPage:'',\n        visible2: false,\n        todelete:'',\n        form: this.$form.createForm(this)\n     };\n  },\n    computed:{\n        userInfo() {\n            return this.$store.getters.userInfo\n        }\n    },\n    created() {\n        this.user = this.userInfo\n    },\n  filters: {\n    statusFilter (type) {\n       return statusMap[type].text\n    },\n    statusTypeFilter (type) {\n       return statusMap[type].status\n    }\n  },\n  methods:{\n    onClickDeleteRow () {\n      this.visible2 = false;\n      const newData = [...this.rDataShow]\n      console.log(newData)\n      const target = newData.filter(item => this.todelete === item.id)[0]\n      console.log(target)\n\n      cancelAppointment({ id : target.id}).then((response) => {\n        this.deleteInfo = response.info\n        if(this.deleteInfo !== 'fail'){\n          this.rData = [...response.data]\n          this.rDataShow = this.rData\n        }\n        if(this.deleteInfo === 'ok'){\n          this.$notification.open({\n          message: '取消成功',\n          description: '本条预约取消成功',\n          icon: <a-icon type=\"check\" style=\"color: #108ee9\" />,\n        });\n        }\n        else{\n          this.$notification.open({\n          message: '取消失败',\n          description: '本条预约取消失败',\n          icon: <a-icon type=\"warning\" style=\"color: #108ee9\" />,\n        });\n        }\n        this.reload()\n      })\n      // to be complete\n      },\n      onClickRefresh(){\n        this.reload()\n      },\n      onClickDelete (id) {\n        console.log(id)\n        this.todelete = id\n        this.visible2 = true;\n      },\n      onChange(current){\n        this.current=current;\n        getMyReserve({'id':this.userInfo.id,'page':this.current-1}).then((response)=>{\n        console.log(response);\n        console.log(this.page);\n        this.rData=response.data;\n        this.rDataShow=this.rData.list;\n        this.totalPage=this.rData.page\n      })\n     }\n    },\n    mounted(){\n      console.log(\"my\")\n        //this.userInfo.id  this.current-1\n        console.log(this.userInfo.id);\n      getMyReserve({'id':this.userInfo.id,'page':this.current-1}).then((response)=>{\n        console.log(response);\n        console.log(this.page);\n        this.rData=response.data;\n        this.rDataShow=this.rData.list;\n        this.totalPage=this.rData.total\n      })\n    }\n  };\n\n</script>\n\n<style lang=\"less\" scoped>\n@import '~ant-design-vue/lib/style/themes/default.less';\n.button-group {\n  margin-bottom: 1rem;\n  .button {\n    margin-left: 0.5rem;\n    margin-left: 0.5rem;\n  }\n}\n</style>\n"]}]}
{"remainingRequest":"D:\\Documents\\GitHub\\Psyche\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Documents\\GitHub\\Psyche\\front-end\\src\\views\\sheets\\checkSheet.vue?vue&type=style&index=0&id=650edf88&lang=less&scoped=true&","dependencies":[{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\src\\views\\sheets\\checkSheet.vue","mtime":1562888527508},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\node_modules\\css-loader\\index.js","mtime":1573722966629},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1573725517685},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\node_modules\\postcss-loader\\src\\index.js","mtime":1573722998988},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\node_modules\\less-loader\\dist\\cjs.js","mtime":1573723014394},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1573722996621},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1573725517685}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n@import '~ant-design-vue/lib/style/themes/default.less';\r\n.button-group {\r\n  margin-bottom: 1rem;\r\n  .button {\r\n    margin-left: 0.5rem;\r\n    margin-left: 0.5rem;\r\n  }\r\n}\r\n",{"version":3,"sources":["checkSheet.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"checkSheet.vue","sourceRoot":"src/views/sheets","sourcesContent":["<template>\r\n  <page-view title=\"巡检单管理\">\r\n    <div>\r\n      <div>\r\n        <a-form class=\"ant-advanced-search-form\" :form=\"form\">\r\n          <a-row :gutter=\"24\">\r\n            <a-col :md=\"8\" :sm=\"24\">\r\n              <a-form-item label=\"巡检单单号\">\r\n                <a-input placeholder=\"请输入巡检单单号\" v-model=\"input\"/>\r\n              </a-form-item>\r\n            </a-col>\r\n          </a-row>\r\n          <a-row :gutter='24'>\r\n            <a-col :md=\"8\" :sm=\"24\" :lg='10'>\r\n              <a-form-item label=\"根据编号查找巡检员\">\r\n                <a-input placeholder=\"请输入巡检员编号\" v-model=\"input2\"/>\r\n              </a-form-item>\r\n            </a-col>\r\n\r\n            <a-col :md=\"8\" :sm=\"24\" :lg='10'>\r\n              <a-form-item label=\"根据姓名查找巡检员\">\r\n                <a-input placeholder=\"请输入巡检员姓名\" v-model=\"input3\"/>\r\n              </a-form-item>\r\n            </a-col>\r\n\r\n          </a-row>\r\n          <a-row>\r\n            <a-col :span=\"4\" style=\" textAlign: 'left';margin-bottom: 24px\">\r\n              <a-button\r\n                size=\"large\"\r\n                class=\"button\"\r\n                type=\"primary\"\r\n                @click=\"onClickRefresh\"\r\n              >刷新表单\r\n              </a-button>\r\n            </a-col>\r\n          </a-row>\r\n        </a-form>\r\n      </div>\r\n      <!-- table -->\r\n      <a-card>\r\n        <a-table :columns=\"columns\" :dataSource=\"DataShow\" rowKey='id' bordered>\r\n          <template\r\n            v-for=\"col in ['id','potrolID', '','eqID','checkTime','checkArea']\"\r\n            :slot=\"col\"\r\n            slot-scope=\"text\"\r\n          >\r\n            <div :key=\"col\">\r\n              {{ text }}\r\n            </div>\r\n          </template>\r\n          <template slot=\"checkPic\" slot-scope=\"text\">\r\n            <!--<div>\r\n              <a-avatar slot=\"avatar\" size=\"large\" shape=\"square\" :src=\"text\"/>\r\n            </div>-->\r\n            <div id=\"app\">\r\n              <div class=\"\">\r\n                <div\r\n                  class=\"pic\"\r\n                  @click=\"() => showImg(text)\"\r\n                >\r\n                  <a-avatar :src=\"text\"/>\r\n                </div>\r\n              </div>\r\n              <vue-easy-lightbox\r\n                :visible=\"visible\"\r\n                :imgs=\"src\"\r\n                @hide=\"handleHide\"\r\n              ></vue-easy-lightbox>\r\n            </div>\r\n          </template>\r\n          <template slot=\"operation\" slot-scope=\"text, record\">\r\n            <div class=\"button\">\r\n              <a-button\r\n                size=\"small\"\r\n                type=\"danger\"\r\n                @click=\"onClickDelete(record.id)\"\r\n              >删除\r\n              </a-button>\r\n              <a-modal\r\n                title=\"确认删除\"\r\n                v-model=\"visible2\"\r\n                @ok=\"onClickDeleteRow\"\r\n              >\r\n                <div class=\"modal\">\r\n                  是否删除本条记录\r\n                </div>\r\n              </a-modal>\r\n            </div>\r\n          </template>\r\n        </a-table>\r\n      </a-card>\r\n      <!-- table end -->\r\n      <!-- add bar -->\r\n      <!-- add bar end -->\r\n    </div>\r\n  </page-view>\r\n</template>\r\n\r\n<script>\r\nimport { getCheckSheet, deleteCheckSheetRow } from '@/api/sheets'\r\nimport Vue from 'vue'\r\nimport Fuse from 'fuse.js'\r\nimport Lightbox from 'vue-easy-lightbox'\r\nimport { PageView } from '@/layouts'\r\n\r\nVue.use(Lightbox)\r\n\r\nconst columns = [{\r\n  title: '巡检单单号',\r\n  dataIndex: 'id',\r\n  align: 'center',\r\n  sorter: (a, b) => a.id > b.id,\r\n}, {\r\n  title: '巡检员编号',\r\n  dataIndex: 'potrolID',\r\n  align: 'center',\r\n  sorter: (a, b) => a.potrolID > b.potrolID,\r\n}, {\r\n  title: '巡检员姓名',\r\n  dataIndex: 'potrolName',\r\n  align: 'center',\r\n  sorter: (a, b) => a.potrolID > b.potrolID,\r\n},{\r\n  title: '巡检器材编号',\r\n  dataIndex: 'eqID',\r\n  align: 'center',\r\n  sorter: (a, b) => a.eqID > b.eqID,\r\n}, {\r\n  title: '巡检时间',\r\n  dataIndex: 'checkTime',\r\n  align: 'center',\r\n  sorter: (a, b) => a.checkTime > b.checkTime\r\n},{\r\n  title: '巡检地区',\r\n  align: 'center',\r\n  dataIndex: 'checkArea',\r\n},{\r\n  title: '巡检结果图片',\r\n  align: 'center',\r\n  dataIndex: 'checkPic',\r\n  scopedSlots: { customRender: 'checkPic' }\r\n},{\r\n  titile: '操作',\r\n  align: 'center',\r\n  dataIndex: 'operation',\r\n  scopedSlots: { customRender: 'operation' }\r\n}];\r\n\r\nconst Data = []\r\nconst DataShow = []\r\n\r\nexport default {\r\n  components: {\r\n    PageView\r\n  },\r\n  inject: ['reload'],\r\n  data() {\r\n    this.cacheData = Data.map(item => ({ ...item }))\r\n    return {\r\n      Data,\r\n      DataShow,\r\n      input: '',\r\n      input2: '',\r\n      input3: '',\r\n      columns,\r\n      visible: false,\r\n      visible2: false,\r\n      src: \"\",\r\n      deleteInfo:'',\r\n      isRouterAlive: true,\r\n      todelete:'',\r\n      form: this.$form.createForm(this)\r\n    }\r\n  },\r\n  watch:{\r\n      input(pattern){\r\n          if(pattern == ''){\r\n              this.DataShow = this.Data\r\n          }\r\n          else{\r\n              const option = {\r\n                  keys: ['id'],\r\n                  threshold: 0.1\r\n              }\r\n              var fuse = new Fuse(this.Data,option)\r\n              this.DataShow = fuse.search(pattern)\r\n          }\r\n      },\r\n      input2(pattern){\r\n          if(pattern == ''){\r\n              this.DataShow = this.Data\r\n          }\r\n          else{\r\n              const option = {\r\n                  keys: ['potrolID'],\r\n                  threshold: 0.1\r\n              }\r\n              var fuse = new Fuse(this.Data,option)\r\n              this.DataShow = fuse.search(pattern)\r\n          }\r\n      },\r\n      input3(pattern){\r\n          if(pattern == ''){\r\n              this.DataShow = this.Data\r\n          }\r\n          else{\r\n              const option = {\r\n                  keys: ['potrolName'],\r\n                  threshold: 0.1\r\n              }\r\n              var fuse = new Fuse(this.Data,option)\r\n              this.DataShow = fuse.search(pattern)\r\n          }\r\n      }\r\n  },\r\n  computed:{\r\n\r\n  },\r\n  methods: {\r\n    showImg (text) {\r\n        this.visible = true\r\n        this.src = text\r\n      },\r\n    //select\r\n    handleHide () {\r\n      this.visible = false\r\n    },\r\n\r\n    onClickRefresh(){\r\n      this.reload()\r\n    },\r\n    //delete\r\n    onClickDelete (id) {\r\n      this.todelete = id\r\n      this.visible2 = true;\r\n    },\r\n    handleOK(e){\r\n        this.visible2 = false;\r\n        //to be completed\r\n    },\r\n    onClickDeleteRow () {\r\n      this.visible2 = false;\r\n      const newData = [...this.DataShow]\r\n      console.log(newData)\r\n      const target = newData.filter(item => this.todelete === item.id)[0]\r\n      console.log(target)\r\n      deleteCheckSheetRow({ id : target.id}).then((response) => {\r\n        this.deleteInfo = response.info\r\n        console.log('delete', this.deleteInfo)\r\n        if(this.deleteInfo !== 'fail'){\r\n          this.Data = [...response.data]\r\n          this.DataShow = this.Data\r\n          \r\n        }\r\n        if(this.deleteInfo === 'ok'){\r\n          this.$notification.open({\r\n          message: '删除成功',\r\n          description: '本条巡检单记录删除成功',\r\n          icon: <a-icon type=\"check\" style=\"color: #108ee9\" />,\r\n        })\r\n        }\r\n        else{\r\n          this.$notification.open({\r\n          message: '删除失败',\r\n          description: '本条巡检单记录删除失败',\r\n          icon: <a-icon type=\"warning\" style=\"color: #108ee9\" />,\r\n        })\r\n        }\r\n      })\r\n      // to be complete\r\n    },\r\n  },\r\n  mounted () {\r\n    getCheckSheet().then((response) => {\r\n      console.log(...response.data)\r\n      this.Data = [...response.data]\r\n      this.DataShow = this.Data\r\n    })\r\n  }\r\n\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '~ant-design-vue/lib/style/themes/default.less';\r\n.button-group {\r\n  margin-bottom: 1rem;\r\n  .button {\r\n    margin-left: 0.5rem;\r\n    margin-left: 0.5rem;\r\n  }\r\n}\r\n</style>\r\n"]}]}
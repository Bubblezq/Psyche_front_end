{"remainingRequest":"D:\\Documents\\GitHub\\Psyche_front_end\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Documents\\GitHub\\Psyche_front_end\\front-end\\src\\views\\user\\MyPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Documents\\GitHub\\Psyche_front_end\\front-end\\src\\views\\user\\MyPage.vue","mtime":1576607738821},{"path":"D:\\Documents\\GitHub\\Psyche_front_end\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1573722996621},{"path":"D:\\Documents\\GitHub\\Psyche_front_end\\front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":1573725483614},{"path":"D:\\Documents\\GitHub\\Psyche_front_end\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1573722996621},{"path":"D:\\Documents\\GitHub\\Psyche_front_end\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1573725517685}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { STable } from '@/components'\nimport { PageView } from '@/layouts'\nimport Fuse from 'fuse.js'\nimport md5 from 'md5'\nimport ARow from \"ant-design-vue/es/grid/Row\";\nimport ACol from \"ant-design-vue/es/grid/Col\";\nimport {timeFix} from '@/utils/util'\nimport {mapGetters} from 'vuex'\nimport {Button} from 'ant-design-vue'\nimport HeadInfo from '@/components/tools/HeadInfo'\nimport {Radar} from '@/components'\nimport {getMyPost, getMyLike} from '@/api/myInfo'\nimport {deleteTreehole} from '@/api/Treehole'\nimport AFormItem from \"ant-design-vue/es/form/FormItem\";\n\nexport default {\n    components: {\n        AFormItem,\n        ACol,\n        ARow,\n        PageView,\n        Radar,\n        STable,\n      },\n    data() {\n      return {\n        timeFix: timeFix(),\n        avatar: '',\n        user: {},\n        projects: [],\n        loading: true,\n        radarLoading: true,\n        activities: [],\n        teams: [],\n        old_password: '',\n        new_password: '',\n        form: this.$form.createForm(this),\n        showPasswordForm: false,\n        new_identity: {\n          id: '',\n          newPassword: '',\n        },\n        visible3: false,\n        postData: [],\n        likeData: [],\n        allPostData: [],\n        allLikeData: [],\n        totalPage1: '',\n        totalPage2: '',\n        current1: 1,\n        current2: 1,\n        loading: true,\n        radarLoading: true,\n        deleteInfo:'',\n        todelete:'',\n        confirmLoading: false,\n          //userInfo:this.$store.getters.userInfo,\n\n        tabList: [\n          {\n            key: 'tab1',\n            // tab: 'tab1',\n            scopedSlots: { tab: 'customRender' },\n          },\n          {\n            key: 'tab2',\n            tab: 'tab2',\n          },\n        ],\n        tabListNoTitle: [\n          {\n            key: '发帖',\n            tab: '发帖',\n          },\n          {\n            key: '收藏',\n            tab: '收藏',\n          },\n        ],\n        key: 'tab1',\n        noTitleKey: '发帖',\n      };\n    },\n    computed: {\n      userInfo() {\n        return this.$store.getters.userInfo\n      }\n    },\n    created() {\n      this.user = this.$store.getters.userInfo\n      this.avatar = this.userInfo.avatar\n    },\n    methods: {\n      ...mapGetters(['nickname', 'welcome']),\n      cancelModifyPassword() {\n        console.log('Cancel modify passsword')\n      },\n      modifyPassButton() {\n        this.showPasswordForm = true;\n      },\n      cancelModifyPassword() {\n        this.showPasswordForm = false;\n      },\n      handleSubmit(e) {\n        e.preventDefault()\n        this.form.validateFields((err, value) => {\n          if (!err) {\n            if (md5(value.old_password) === this.userInfo.password) {\n              this.new_identity.newPassword = md5(value.new_password)\n              this.new_identity.id = this.userInfo.id\n              console.log(this.new_identity)\n              modifyPassword(this.new_identity).then(() => {\n                this.$message.success('密码修改成功！')\n              })\n              console.log(\"Pass!\")\n            } else {\n              this.$message.error('旧密码输入错误！')\n              console.log(\"Failed!\")\n            }\n          }\n        })\n        this.showPasswordForm = false;\n      },\n      onClickCancel(){\n        this.visible3=false;\n      },\n      onChange1(current){\n        this.current1=current;\n          getMyPost({id:1750000,page:(this.current1-1)}).then((response)=>{\n              console.log(response);\n              console.log(this.page);\n              this.allPostData=response.data;\n              this.postData=this.allPostData.list;\n              this.totalPage1=this.allPostData.total\n\n          })\n     },\n     onChange2(current){\n        this.current2=current;\n        getMyLike(this.current2).then((response)=>{\n          console.log(response);\n          console.log(this.page);\n          this.allLikeData=response.data;\n          this.likeData=this.allLikeData.likeData;\n          this.totalPage2=this.allLikeData.total //总页数\n      })\n     },\n     onClickDelete (id) {\n        console.log(id)\n        this.todelete = id\n        this.visible3 = true;\n      },\n      onClickDeleteRow () {\n        this.visible3 = false\n        deleteTreehole(this.todelete).then((response) => {\n        this.deleteInfo = response.info\n        if(this.deleteInfo === 'ok'){\n          this.sfData = [...response.data]\n          this.sfDataShow = this.sfData\n          this.$notification.open({\n          message: '删除成功',\n          description: '本条发帖信息删除成功',\n          icon: <a-icon type=\"check\" style=\"color: #108ee9\" />,\n        });\n        }\n        else{\n          this.$notification.open({\n          message: '删除失败',\n          description: '本条发帖信息删除失败',\n          icon: <a-icon type=\"warning\" style=\"color: #108ee9\" />,\n        });\n        }\n      })\n      },\n    },\n    mounted(){\n      console.log(this.$store.getters.userInfo)\n      getMyPost({id:1750000,page:(this.current1-1)}).then((response)=>{\n        console.log(response);\n        console.log(this.page);\n        this.allPostData=response.data;\n        this.postData=this.allPostData.list;\n        this.totalPage1=this.allPostData.total\n\n      }),\n      getMyLike({id:userInfo.id,page:(this.current2-1)}).then((response)=>{\n        console.log(response);\n        console.log(this.page);\n        this.allLikeData=response.data;\n        this.likeData=this.allLikeData.likeData;\n        this.totalPage2=this.allLikeData.totalPage //总页数\n      })\n    }\n}\n\n",{"version":3,"sources":["MyPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MyPage.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\n  <page-view :avatar=\"userInfo.headPortrait\" :title=\"false\">\n    <div slot=\"headerContent\">\n      <div class=\"title\">{{ timeFix }}，{{ user.name }}！</div>\n    </div>\n    <a-row :gutter=\"24\">\n      <!--个人信息-->\n        <a-col\n          style=\"padding: 0 12px\"\n          :xl=\"8\"\n          :lg=\"24\"\n          :md=\"24\"\n          :sm=\"24\"\n          :xs=\"24\">\n          <!--个人信息-->\n          <a-card\n            style=\"margin-bottom: 24px; margin-top: 0px\"\n            :bordered=\"false\"\n            title=\"个人信息\"\n            :body-style=\"{ padding: 0 }\">\n            <a-card>\n              <a-row style=\"margin-bottom: 12px\">\n                <a-icon type=\"idcard\" theme=\"twoTone\" twoToneColor=\"#3A5FCD\"/>\n                <strong> 学号：</strong>\n                {{ userInfo.id }}\n              </a-row>\n              <a-row style=\"margin-bottom: 12px\">\n                <a-icon type=\"tag\" theme=\"twoTone\" twoToneColor=\"#3A5FCD\"/>\n                <strong> 姓名：</strong>\n                {{ userInfo.name }}\n              </a-row>\n              <a-row style=\"margin-bottom: 12px\">\n                <a-icon type=\"tag\" theme=\"twoTone\" twoToneColor=\"#3A5FCD\"/>\n                <strong> 昵称：</strong>\n                {{ userInfo.nickName }}\n              </a-row>\n            </a-card>\n          </a-card>\n          <!--密码修改-->\n          <div>\n            <a-row style=\"text-align: center\">\n              <a-button @click=\"modifyPassButton\" type=\"primary\" icon=\"lock\"> 修改密码</a-button>\n              <a-modal v-model=\"showPasswordForm\" footer=\"\">\n                <a-form title=\"修改密码\" @submit=\"handleSubmit\" :form=\"form\">\n                  <a-form-item\n                    :wrapperCol=\"{ span: 24 }\"\n                    style=\"text-align: center\"\n                  >\n                    <h3>修改密码</h3>\n                  </a-form-item>\n                  <a-form-item\n                    label=\"旧密码\"\n                    :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\n                    :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\">\n                    <a-input\n                      type=\"password\"\n                      v-decorator=\"[\n            'old_password',\n            {rules: [{ required: true, message: '请输入旧的密码' }]}\n          ]\"\n                      name=\"old_password\"\n                      placeholder=\"请输入旧的密码\"/>\n                  </a-form-item>\n                  <a-form-item\n                    label=\"新密码\"\n                    :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\n                    :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\">\n                    <a-input\n                      type=\"password\"\n                      v-decorator=\"[\n            'new_password',\n            {rules: [{ required: true, message: '请输入新的密码' }]}\n          ]\"\n                      name=\"new_password\"\n                      placeholder=\"请输入新的密码\"/>\n                  </a-form-item>\n                  <a-form-item\n                    :wrapperCol=\"{ span: 24 }\"\n                    style=\"text-align: center\"\n                  >\n                    <a-button htmlType=\"submit\" type=\"primary\">提交</a-button>\n                    <a-button style=\"margin-left: 8px\" @click=\"cancelModifyPassword\">取消</a-button>\n                  </a-form-item>\n\n                </a-form>\n              </a-modal>\n            </a-row>\n          </div>\n        </a-col>\n      <a-col :xl=\"16\" :lg=\"24\" :md=\"24\" :sm=\"24\" :xs=\"24\">\n        <a-card\n          style=\"width:100%\"\n          :tabList=\"tabListNoTitle\"\n          :activeTabKey=\"noTitleKey\"\n          @tabChange=\"key => onTabChange(key, 'noTitleKey')\"\n        >\n      <template v-if=\"noTitleKey === '发帖'\">\n        <a-list :dataSource=\"postData\">\n          <a-list-item slot=\"renderItem\" slot-scope=\"item, index\">\n             <a slot=\"actions\" @click=\"onClickDelete(item.id)\">删除</a>\n             <a-modal\n                title=\"确认删除\"\n                :visible=\"visible3\"\n                @ok=\"onClickDeleteRow\"\n                @cancel=\"onClickCancel\"\n             >\n             <div class=\"modal\">\n                是否删除本条帖子\n             </div>\n             </a-modal>\n              <a-list-item-meta :title='item.title'>\n                <a-avatar\n                  width=\"72\"\n                  slot=\"avatar\"\n                  :src=\"item.headPortrait\"\n                />\n                <div slot=\"description\">\n                  <ellipsis :length=\"70\">{{ item.content }}</ellipsis>\n                </div>\n                </br>\n                <div slot=\"description\">\n                  <ellipsis :length=\"70\">{{ item.sendTime }}</ellipsis>\n                </div>\n\n              </a-list-item-meta>\n              <div>\n                 <router-link :to=\"{ name: 'postDetail', params:{ id: item.id} }\">帖子详情</router-link>\n              </div>\n          </a-list-item>\n        </a-list>\n        <div style=\"margin-top:20px\">\n          <a-pagination @change=\"onChange1\" :current=\"current\" :total=\"(totalPage1+1)*10\" />\n        </div>\n      </template>\n      <template v-else=\"noTitleKey === '收藏'\">\n        <a-list :dataSource=\"likeData\">\n          <a-list-item>\n            <a-card :bordered=\"false\" style=\"width:100%\">\n              <a-card-meta title=\"item.title\">\n                <img style=\"width:100px\"\n                   slot=\"avatar\"\n                   :src=\"item.image\"\n                 />\n              </a-card-meta>\n            </a-card>\n          </a-list-item>\n        </a-list>\n        <div style=\"margin-top:20px\">\n          <a-pagination @change=\"onChange2\" :current=\"current\" :total=\"(totalPage2+1)*10\" />\n        </div>\n      </template>\n       </a-card>\n       </a-card>\n      </a-col>\n    </a-row>\n  </page-view>\n</template>\n\n<script>\nimport { STable } from '@/components'\nimport { PageView } from '@/layouts'\nimport Fuse from 'fuse.js'\nimport md5 from 'md5'\nimport ARow from \"ant-design-vue/es/grid/Row\";\nimport ACol from \"ant-design-vue/es/grid/Col\";\nimport {timeFix} from '@/utils/util'\nimport {mapGetters} from 'vuex'\nimport {Button} from 'ant-design-vue'\nimport HeadInfo from '@/components/tools/HeadInfo'\nimport {Radar} from '@/components'\nimport {getMyPost, getMyLike} from '@/api/myInfo'\nimport {deleteTreehole} from '@/api/Treehole'\nimport AFormItem from \"ant-design-vue/es/form/FormItem\";\n\nexport default {\n    components: {\n        AFormItem,\n        ACol,\n        ARow,\n        PageView,\n        Radar,\n        STable,\n      },\n    data() {\n      return {\n        timeFix: timeFix(),\n        avatar: '',\n        user: {},\n        projects: [],\n        loading: true,\n        radarLoading: true,\n        activities: [],\n        teams: [],\n        old_password: '',\n        new_password: '',\n        form: this.$form.createForm(this),\n        showPasswordForm: false,\n        new_identity: {\n          id: '',\n          newPassword: '',\n        },\n        visible3: false,\n        postData: [],\n        likeData: [],\n        allPostData: [],\n        allLikeData: [],\n        totalPage1: '',\n        totalPage2: '',\n        current1: 1,\n        current2: 1,\n        loading: true,\n        radarLoading: true,\n        deleteInfo:'',\n        todelete:'',\n        confirmLoading: false,\n          //userInfo:this.$store.getters.userInfo,\n\n        tabList: [\n          {\n            key: 'tab1',\n            // tab: 'tab1',\n            scopedSlots: { tab: 'customRender' },\n          },\n          {\n            key: 'tab2',\n            tab: 'tab2',\n          },\n        ],\n        tabListNoTitle: [\n          {\n            key: '发帖',\n            tab: '发帖',\n          },\n          {\n            key: '收藏',\n            tab: '收藏',\n          },\n        ],\n        key: 'tab1',\n        noTitleKey: '发帖',\n      };\n    },\n    computed: {\n      userInfo() {\n        return this.$store.getters.userInfo\n      }\n    },\n    created() {\n      this.user = this.$store.getters.userInfo\n      this.avatar = this.userInfo.avatar\n    },\n    methods: {\n      ...mapGetters(['nickname', 'welcome']),\n      cancelModifyPassword() {\n        console.log('Cancel modify passsword')\n      },\n      modifyPassButton() {\n        this.showPasswordForm = true;\n      },\n      cancelModifyPassword() {\n        this.showPasswordForm = false;\n      },\n      handleSubmit(e) {\n        e.preventDefault()\n        this.form.validateFields((err, value) => {\n          if (!err) {\n            if (md5(value.old_password) === this.userInfo.password) {\n              this.new_identity.newPassword = md5(value.new_password)\n              this.new_identity.id = this.userInfo.id\n              console.log(this.new_identity)\n              modifyPassword(this.new_identity).then(() => {\n                this.$message.success('密码修改成功！')\n              })\n              console.log(\"Pass!\")\n            } else {\n              this.$message.error('旧密码输入错误！')\n              console.log(\"Failed!\")\n            }\n          }\n        })\n        this.showPasswordForm = false;\n      },\n      onClickCancel(){\n        this.visible3=false;\n      },\n      onChange1(current){\n        this.current1=current;\n          getMyPost({id:1750000,page:(this.current1-1)}).then((response)=>{\n              console.log(response);\n              console.log(this.page);\n              this.allPostData=response.data;\n              this.postData=this.allPostData.list;\n              this.totalPage1=this.allPostData.total\n\n          })\n     },\n     onChange2(current){\n        this.current2=current;\n        getMyLike(this.current2).then((response)=>{\n          console.log(response);\n          console.log(this.page);\n          this.allLikeData=response.data;\n          this.likeData=this.allLikeData.likeData;\n          this.totalPage2=this.allLikeData.total //总页数\n      })\n     },\n     onClickDelete (id) {\n        console.log(id)\n        this.todelete = id\n        this.visible3 = true;\n      },\n      onClickDeleteRow () {\n        this.visible3 = false\n        deleteTreehole(this.todelete).then((response) => {\n        this.deleteInfo = response.info\n        if(this.deleteInfo === 'ok'){\n          this.sfData = [...response.data]\n          this.sfDataShow = this.sfData\n          this.$notification.open({\n          message: '删除成功',\n          description: '本条发帖信息删除成功',\n          icon: <a-icon type=\"check\" style=\"color: #108ee9\" />,\n        });\n        }\n        else{\n          this.$notification.open({\n          message: '删除失败',\n          description: '本条发帖信息删除失败',\n          icon: <a-icon type=\"warning\" style=\"color: #108ee9\" />,\n        });\n        }\n      })\n      },\n    },\n    mounted(){\n      console.log(this.$store.getters.userInfo)\n      getMyPost({id:1750000,page:(this.current1-1)}).then((response)=>{\n        console.log(response);\n        console.log(this.page);\n        this.allPostData=response.data;\n        this.postData=this.allPostData.list;\n        this.totalPage1=this.allPostData.total\n\n      }),\n      getMyLike({id:userInfo.id,page:(this.current2-1)}).then((response)=>{\n        console.log(response);\n        console.log(this.page);\n        this.allLikeData=response.data;\n        this.likeData=this.allLikeData.likeData;\n        this.totalPage2=this.allLikeData.totalPage //总页数\n      })\n    }\n}\n\n</script>\n\n<style lang=\"less\" scoped>\n.addButton{\n    position: absolute;\n    z-index: 999;\n    right:1em;\n    top:0em;\n  }\n</style>"]}]}
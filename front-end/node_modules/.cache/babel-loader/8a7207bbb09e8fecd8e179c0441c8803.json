{"remainingRequest":"D:\\Documents\\GitHub\\Psyche\\front-end\\node_modules\\babel-loader\\lib\\index.js!D:\\Documents\\GitHub\\Psyche\\front-end\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\Documents\\GitHub\\Psyche\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Documents\\GitHub\\Psyche\\front-end\\src\\views\\sheets\\workSheet.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\src\\views\\sheets\\workSheet.vue","mtime":1562888527512},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1573722996621},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":1573725483614},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1573722996621},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1573725517685}],"contextDependencies":[],"result":["import _toConsumableArray from \"D:\\\\Documents\\\\GitHub\\\\Psyche\\\\front-end\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.regexp.search\";\nimport _objectSpread from \"D:\\\\Documents\\\\GitHub\\\\Psyche\\\\front-end\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Fuse from 'fuse.js';\nimport Vue from 'vue';\nimport Lightbox from 'vue-easy-lightbox';\nimport { PageView } from '@/layouts';\nVue.use(Lightbox);\nimport { getWorkSheet, deleteWorkSheetRow } from '@/api/sheets';\nvar statusMap = {\n  0: {\n    status: 'processing',\n    text: '进行'\n  },\n  1: {\n    status: 'success',\n    text: '完成'\n  } // columns type name\n\n};\nvar columns = [{\n  title: '工单单号',\n  dataIndex: 'id',\n  //width: '10%',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'id'\n  },\n  sorter: function sorter(a, b) {\n    return a.id > b.id;\n  }\n}, {\n  title: '被维修器件编号',\n  dataIndex: 'equipID',\n  // width: '15%',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'equipID'\n  },\n  sorter: function sorter(a, b) {\n    return a.equipID > b.equipID;\n  }\n}, {\n  title: '指定维修员编号',\n  dataIndex: 'repairerID',\n  //width: '15%',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'repairerID'\n  },\n  sorter: function sorter(a, b) {\n    return a.repairerID > b.repairerID;\n  }\n}, {\n  title: '维修员姓名',\n  dataIndex: 'repairerName',\n  //width: '15%',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'repairerName'\n  }\n}, {\n  title: '维修区域',\n  dataIndex: 'repairArea',\n  //width: '12%',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'repairArea'\n  }\n}, {\n  title: '调度员编号',\n  dataIndex: 'dispatcherID',\n  //width: '13%',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'dispatcherID'\n  },\n  sorter: function sorter(a, b) {\n    return a.dispatcherID > b.dispatcherID;\n  }\n}, {\n  title: '调度员姓名',\n  dataIndex: 'dispatcherName',\n  //width: '13%',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'dispatcherName'\n  }\n}, {\n  title: '工单状态',\n  dataIndex: 'statue',\n  align: 'center',\n  //width: '12%',\n  filters: [{\n    text: '进行',\n    value: '0'\n  }, {\n    text: '完成',\n    value: '1'\n  }],\n  onFilter: function onFilter(value, record) {\n    return record.statue.indexOf(value) === 0;\n  },\n  scopedSlots: {\n    customRender: 'statue'\n  }\n}, {\n  title: '维修结果图片',\n  align: 'center',\n  dataIndex: 'work_picture',\n  scopedSlots: {\n    customRender: 'work_picture'\n  }\n}, {\n  titile: '操作',\n  align: 'center',\n  dataIndex: 'operation',\n  scopedSlots: {\n    customRender: 'operation'\n  }\n}]; // sheets data\n\nvar wData = [];\nvar wDataShow = [];\nexport default {\n  name: 'workSheet',\n  inject: ['reload'],\n  components: {\n    PageView: PageView\n  },\n  data: function data() {\n    this.cacheData = wData.map(function (item) {\n      return _objectSpread({}, item);\n    });\n    return {\n      attributeID: {\n        type: 'id',\n        cnType: '工单单号',\n        guide: '请输入单号'\n      },\n      attributeRepairer: {\n        type: 'repairerID',\n        cnType: '查询特定维修员的工单',\n        guide: '请输入维修员编号'\n      },\n      input: '',\n      input2: '',\n      input3: '',\n      input4: '',\n      input5: '',\n      wData: wData,\n      wDataShow: wDataShow,\n      deleteInfo: '',\n      columns: columns,\n      // information of add\n      isRouterAlive: true,\n      visible: false,\n      visible2: false,\n      src: \"\",\n      todelete: '',\n      form: this.$form.createForm(this)\n    };\n  },\n  watch: {\n    input: function input(pattern) {\n      if (pattern == '') {\n        this.wDataShow = this.wData;\n      } else {\n        var option = {\n          keys: ['id'],\n          threshold: 0.1\n        };\n        var fuse = new Fuse(this.wData, option);\n        this.wDataShow = fuse.search(pattern);\n      }\n    },\n    input2: function input2(pattern) {\n      if (pattern == '') {\n        this.wDataShow = this.wData;\n      } else {\n        var option = {\n          keys: ['repairerID'],\n          threshold: 0.1\n        };\n        var fuse = new Fuse(this.wData, option);\n        this.wDataShow = fuse.search(pattern);\n      }\n    },\n    input3: function input3(pattern) {\n      if (pattern == '') {\n        this.wDataShow = this.wData;\n      } else {\n        var option = {\n          keys: ['repairerName'],\n          threshold: 0.1\n        };\n        var fuse = new Fuse(this.wData, option);\n        this.wDataShow = fuse.search(pattern);\n      }\n    },\n    input4: function input4(pattern) {\n      if (pattern == '') {\n        this.wDataShow = this.wData;\n      } else {\n        var option = {\n          keys: ['dispatcherID'],\n          threshold: 0.1\n        };\n        var fuse = new Fuse(this.wData, option);\n        this.wDataShow = fuse.search(pattern);\n      }\n    },\n    input5: function input5(pattern) {\n      if (pattern == '') {\n        this.wDataShow = this.wData;\n      } else {\n        var option = {\n          keys: ['dispatcherName'],\n          threshold: 0.1\n        };\n        var fuse = new Fuse(this.wData, option);\n        this.wDataShow = fuse.search(pattern);\n      }\n    }\n  },\n  filters: {\n    statusFilter: function statusFilter(type) {\n      return statusMap[type].text;\n    },\n    statusTypeFilter: function statusTypeFilter(type) {\n      return statusMap[type].status;\n    }\n  },\n  methods: {\n    showImg: function showImg(text) {\n      this.visible = true;\n      this.src = text;\n    },\n    handleHide: function handleHide() {\n      this.visible = false;\n    },\n    //delete row\n    onClickDeleteRow: function onClickDeleteRow() {\n      var _this = this;\n\n      var h = this.$createElement;\n      this.visible2 = false;\n\n      var newData = _toConsumableArray(this.wDataShow);\n\n      console.log(newData);\n      var target = newData.filter(function (item) {\n        return _this.todelete === item.id;\n      })[0];\n      console.log(target);\n\n      if (target.statue === '0') {\n        this.$notification.open({\n          message: '删除失败',\n          description: '未完成的工单不可删除',\n          icon: h(\"a-icon\", {\n            \"attrs\": {\n              \"type\": \"warning\"\n            },\n            \"style\": \"color: #108ee9\"\n          })\n        });\n        return;\n      }\n\n      deleteWorkSheetRow({\n        id: target.id\n      }).then(function (response) {\n        _this.deleteInfo = response.info;\n\n        if (_this.deleteInfo !== 'fail') {\n          _this.wData = _toConsumableArray(response.data);\n          _this.wDataShow = _this.wData;\n        }\n\n        if (_this.deleteInfo === 'ok') {\n          _this.$notification.open({\n            message: '删除成功',\n            description: '本条工单记录删除成功',\n            icon: h(\"a-icon\", {\n              \"attrs\": {\n                \"type\": \"check\"\n              },\n              \"style\": \"color: #108ee9\"\n            })\n          });\n        } else {\n          _this.$notification.open({\n            message: '删除失败',\n            description: '本条工单记录删除失败',\n            icon: h(\"a-icon\", {\n              \"attrs\": {\n                \"type\": \"warning\"\n              },\n              \"style\": \"color: #108ee9\"\n            })\n          });\n        }\n      }); // to be complete\n    },\n    onClickRefresh: function onClickRefresh() {\n      this.reload();\n    },\n    //modal dispear\n    onClickDelete: function onClickDelete(id) {\n      console.log(id);\n      this.todelete = id;\n      this.visible2 = true;\n    }\n  },\n  mounted: function mounted() {\n    var _this2 = this;\n\n    console.log(columns[5]);\n    getWorkSheet().then(function (response) {\n      var _console;\n\n      (_console = console).log.apply(_console, _toConsumableArray(response.data));\n\n      _this2.wData = _toConsumableArray(response.data);\n      _this2.wDataShow = _this2.wData;\n    });\n  }\n};",{"version":3,"sources":["workSheet.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <page-view title=\"工单管理\">\r\n    <div>\r\n      <!-- input bar -->\r\n      <div>\r\n        <a-form class=\"ant-advanced-search-form\" :form=\"form\">\r\n          <a-row :gutter=\"24\">\r\n            <a-col :md=\"8\" :sm=\"24\">\r\n              <a-form-item label=\"查找工单\">\r\n                <a-input placeholder=\"请输入工单单号\" v-model=\"input\"/>\r\n              </a-form-item>\r\n            </a-col>\r\n          </a-row>\r\n          <a-row :gutter='24'>\r\n            <a-col :md=\"8\" :sm=\"24\" :lg='10'>\r\n              <a-form-item label=\"根据编号查找维修员\">\r\n                <a-input placeholder=\"请输入维修员编号\" v-model=\"input2\"/>\r\n              </a-form-item>\r\n            </a-col>\r\n            <a-col :md=\"8\" :sm=\"24\" :lg='10'>\r\n              <a-form-item label=\"根据姓名查找维修员\">\r\n                <a-input placeholder=\"请输入维修员姓名\" v-model=\"input3\"/>\r\n              </a-form-item>\r\n            </a-col>\r\n          </a-row>\r\n          <a-row :gutter='24'>\r\n            <a-col :md=\"8\" :sm=\"24\" :lg='10'>\r\n              <a-form-item label=\"根据编号查找调度员\">\r\n                <a-input placeholder=\"请输入调度员编号\" v-model=\"input4\"/>\r\n              </a-form-item>\r\n            </a-col>\r\n            <a-col :md=\"8\" :sm=\"24\" :lg='10'>\r\n              <a-form-item label=\"根据姓名查找调度员\">\r\n                <a-input placeholder=\"请输入调度员姓名\" v-model=\"input5\"/>\r\n              </a-form-item>\r\n            </a-col>\r\n          </a-row>\r\n          <a-row>\r\n            <a-col :span=\"4\" style=\" textAlign: 'left';margin-bottom: 24px\">\r\n              <a-button\r\n                size=\"large\"\r\n                class=\"button\"\r\n                type=\"primary\"\r\n                @click=\"onClickRefresh\"\r\n              >刷新表单\r\n              </a-button>\r\n              <br>\r\n            </a-col>\r\n          </a-row>\r\n        </a-form>\r\n      </div>\r\n      <!-- input bar end -->\r\n      <!-- table -->\r\n      <a-card>\r\n        <a-table :columns=\"columns\" :dataSource=\"wDataShow\" rowKey='id' bordered>\r\n          <template\r\n            v-for=\"col in ['id','equipID', 'repairerID','repairerName','repairArea','dispatcherID','dispatcherName','statue']\"\r\n            :slot=\"col\"\r\n            slot-scope=\"text\"\r\n          >\r\n            <div :key=\"col\">\r\n              {{ text }}\r\n            </div>\r\n          </template>\r\n\r\n          <template slot='statue' slot-scope=\"text\">\r\n            <a-badge :status=\"text | statusTypeFilter\" :text=\"text | statusFilter\"/>\r\n          </template>\r\n          <template slot=\"work_picture\" slot-scope=\"text\">\r\n            <!--<div>\r\n              <a-avatar slot=\"avatar\" size=\"large\" shape=\"square\" :src=\"text\"/>\r\n            </div>-->\r\n            <div id=\"app\">\r\n              <div class=\"\">\r\n                <div\r\n                  class=\"pic\"\r\n                  @click=\"() => showImg(text)\"\r\n                >\r\n                  <a-avatar :src=\"text\"/>\r\n                </div>\r\n              </div>\r\n              <vue-easy-lightbox\r\n                :visible=\"visible\"\r\n                :imgs=\"src\"\r\n                @hide=\"handleHide\"\r\n              ></vue-easy-lightbox>\r\n            </div>\r\n          </template>\r\n          <template slot=\"operation\" slot-scope=\"text, record\">\r\n            <a-button\r\n              size=\"small\"\r\n              type=\"danger\"\r\n              :hidden='text'\r\n              @click=\"onClickDelete(record.id)\"\r\n            >删除\r\n            </a-button>\r\n            <a-modal\r\n              title=\"确认删除\"\r\n              v-model=\"visible2\"\r\n              @ok=\"onClickDeleteRow\"\r\n            >\r\n              <div class=\"modal\">\r\n                是否删除本条记录\r\n              </div>\r\n            </a-modal>\r\n          </template>\r\n        </a-table>\r\n      </a-card>\r\n      <!-- table end -->\r\n    </div>\r\n  </page-view>\r\n</template>\r\n\r\n\r\n<script>\r\nimport Fuse from 'fuse.js'\r\nimport Vue from 'vue'\r\nimport Lightbox from 'vue-easy-lightbox'\r\nimport { PageView } from '@/layouts'\r\n\r\n\r\nVue.use(Lightbox)\r\nimport { getWorkSheet, deleteWorkSheetRow } from '@/api/sheets'\r\n\r\n\r\nconst statusMap = {\r\n  0: {\r\n    status: 'processing',\r\n    text: '进行'\r\n  },\r\n  1: {\r\n    status: 'success',\r\n    text: '完成'\r\n  }\r\n}\r\n\r\n// columns type name\r\n\r\nconst columns = [{\r\n  title: '工单单号',\r\n  dataIndex: 'id',\r\n  //width: '10%',\r\n  align: 'center',\r\n  scopedSlots: { customRender: 'id' },\r\n  sorter: (a, b) => a.id > b.id,\r\n}, {\r\n  title: '被维修器件编号',\r\n  dataIndex: 'equipID',\r\n // width: '15%',\r\n  align: 'center',\r\n  scopedSlots: { customRender: 'equipID' },\r\n  sorter: (a, b) => a.equipID > b.equipID,\r\n}, {\r\n  title: '指定维修员编号',\r\n  dataIndex: 'repairerID',\r\n  //width: '15%',\r\n  align: 'center',\r\n  scopedSlots: { customRender: 'repairerID' },\r\n  sorter: (a, b) => a.repairerID > b.repairerID,\r\n},{\r\n  title: '维修员姓名',\r\n  dataIndex: 'repairerName',\r\n  //width: '15%',\r\n  align: 'center',\r\n  scopedSlots: { customRender: 'repairerName' },\r\n},{\r\n  title: '维修区域',\r\n  dataIndex: 'repairArea',\r\n  //width: '12%',\r\n  align: 'center',\r\n  scopedSlots: { customRender: 'repairArea' }\r\n},{\r\n  title: '调度员编号',\r\n  dataIndex: 'dispatcherID',\r\n  //width: '13%',\r\n  align: 'center',\r\n  scopedSlots: { customRender: 'dispatcherID' },\r\n  sorter: (a, b) => a.dispatcherID > b.dispatcherID,\r\n},{\r\n  title: '调度员姓名',\r\n  dataIndex: 'dispatcherName',\r\n  //width: '13%',\r\n  align: 'center',\r\n  scopedSlots: { customRender: 'dispatcherName' },\r\n}, {\r\n  title: '工单状态',\r\n  dataIndex: 'statue',\r\n  align: 'center',\r\n  //width: '12%',\r\n  filters: [{\r\n    text: '进行',\r\n    value: '0'\r\n  },{\r\n    text: '完成',\r\n    value: '1'\r\n  }],\r\n  onFilter: (value, record) => record.statue.indexOf(value) === 0,\r\n  scopedSlots: { customRender: 'statue' },\r\n},{\r\n  title: '维修结果图片',\r\n  align: 'center',\r\n  dataIndex: 'work_picture',\r\n  scopedSlots: { customRender: 'work_picture' }\r\n},{\r\n  titile: '操作',\r\n  align: 'center',\r\n  dataIndex: 'operation',\r\n  scopedSlots: { customRender: 'operation' }\r\n}]\r\n\r\n\r\n// sheets data\r\nconst wData = []\r\nconst wDataShow = []\r\nexport default {\r\n  name: 'workSheet',\r\n  inject: ['reload'],\r\n  components: {\r\n    PageView\r\n  },\r\n  data() {\r\n    this.cacheData = wData.map(item => ({ ...item }))\r\n    return {\r\n      attributeID: {\r\n        type: 'id',\r\n        cnType: '工单单号',\r\n        guide: '请输入单号'\r\n      },\r\n      attributeRepairer: {\r\n        type: 'repairerID',\r\n        cnType: '查询特定维修员的工单',\r\n        guide: '请输入维修员编号'\r\n      },\r\n      input: '',\r\n      input2: '',\r\n      input3: '',\r\n      input4:'',\r\n      input5:'',\r\n      wData,\r\n      wDataShow,\r\n      deleteInfo: '',\r\n      columns,\r\n      // information of add\r\n      isRouterAlive: true,\r\n      visible: false,\r\n      visible2: false,\r\n      src: \"\",\r\n      todelete:'',\r\n      form: this.$form.createForm(this)\r\n    }\r\n  },\r\n  watch:{\r\n    \r\n    input(pattern){\r\n          if(pattern == ''){\r\n              this.wDataShow = this.wData\r\n          }\r\n          else{\r\n              const option = {\r\n                  keys: ['id'],\r\n                  threshold: 0.1\r\n              }\r\n              var fuse = new Fuse(this.wData,option)\r\n              this.wDataShow = fuse.search(pattern)\r\n          }\r\n      },\r\n    input2(pattern){\r\n        if(pattern == ''){\r\n            this.wDataShow = this.wData\r\n        }\r\n        else{\r\n            const option = {\r\n                keys: ['repairerID'],\r\n                threshold: 0.1\r\n            }\r\n            var fuse = new Fuse(this.wData,option)\r\n            this.wDataShow = fuse.search(pattern)\r\n          }\r\n      },\r\n    input3(pattern){\r\n          if(pattern == ''){\r\n              this.wDataShow = this.wData\r\n          }\r\n          else{\r\n              const option = {\r\n                  keys: ['repairerName'],\r\n                  threshold: 0.1\r\n              }\r\n              var fuse = new Fuse(this.wData,option)\r\n              this.wDataShow = fuse.search(pattern)\r\n          }\r\n      },\r\n    input4(pattern){\r\n          if(pattern == ''){\r\n              this.wDataShow = this.wData\r\n          }\r\n          else{\r\n              const option = {\r\n                  keys: ['dispatcherID'],\r\n                  threshold: 0.1\r\n              }\r\n              var fuse = new Fuse(this.wData,option)\r\n              this.wDataShow = fuse.search(pattern)\r\n          }\r\n      },\r\n    input5(pattern){\r\n          if(pattern == ''){\r\n              this.wDataShow = this.wData\r\n          }\r\n          else{\r\n              const option = {\r\n                  keys: ['dispatcherName'],\r\n                  threshold: 0.1\r\n              }\r\n              var fuse = new Fuse(this.wData,option)\r\n              this.wDataShow = fuse.search(pattern)\r\n          }\r\n      },\r\n      \r\n  },\r\n  \r\n  filters: {\r\n    statusFilter (type) {\r\n      return statusMap[type].text\r\n    },\r\n    statusTypeFilter (type) {\r\n      return statusMap[type].status\r\n    }\r\n  },\r\n  \r\n  methods: {\r\n    showImg (text) {\r\n        this.visible = true\r\n        this.src = text\r\n      },\r\n    handleHide () {\r\n      this.visible = false\r\n    },\r\n    //delete row\r\n    onClickDeleteRow () {\r\n      this.visible2 = false;\r\n      const newData = [...this.wDataShow]\r\n      console.log(newData)\r\n      const target = newData.filter(item => this.todelete === item.id)[0]\r\n      console.log(target)\r\n      if(target.statue === '0'){\r\n          this.$notification.open({\r\n          message: '删除失败',\r\n          description: '未完成的工单不可删除',\r\n          icon: <a-icon type=\"warning\" style=\"color: #108ee9\" />,\r\n        });\r\n        return\r\n      }\r\n      \r\n      deleteWorkSheetRow({ id : target.id}).then((response) => {\r\n        this.deleteInfo = response.info\r\n        if(this.deleteInfo !== 'fail'){\r\n          this.wData = [...response.data]\r\n          this.wDataShow = this.wData\r\n        }\r\n        if(this.deleteInfo === 'ok'){\r\n          this.$notification.open({\r\n          message: '删除成功',\r\n          description: '本条工单记录删除成功',\r\n          icon: <a-icon type=\"check\" style=\"color: #108ee9\" />,\r\n        });\r\n        }\r\n        else{\r\n          this.$notification.open({\r\n          message: '删除失败',\r\n          description: '本条工单记录删除失败',\r\n          icon: <a-icon type=\"warning\" style=\"color: #108ee9\" />,\r\n        });\r\n        }\r\n      })\r\n      // to be complete\r\n    },\r\n    onClickRefresh(){\r\n      this.reload()\r\n    },\r\n    //modal dispear\r\n    onClickDelete (id) {\r\n      console.log(id)\r\n      this.todelete = id\r\n      this.visible2 = true;\r\n    },\r\n   \r\n  },\r\n  mounted () {\r\n    console.log(columns[5])\r\n    getWorkSheet().then((response) => {\r\n      console.log(...response.data)\r\n      this.wData = [...response.data]\r\n      this.wDataShow = this.wData\r\n    })\r\n    \r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '~ant-design-vue/lib/style/themes/default.less';\r\n.button-group {\r\n  margin-bottom: 1rem;\r\n  .button {\r\n    margin-left: 0.5rem;\r\n    margin-left: 0.5rem;\r\n  }\r\n}\r\n</style>\r\n\r\n"],"sourceRoot":"src/views/sheets"}]}
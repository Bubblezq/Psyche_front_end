{"remainingRequest":"C:\\Users\\Gavin Yu\\Desktop\\Gitproj\\front-end\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Gavin Yu\\Desktop\\Gitproj\\front-end\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Gavin Yu\\Desktop\\Gitproj\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Gavin Yu\\Desktop\\Gitproj\\front-end\\src\\views\\counseling\\MyReservation.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Gavin Yu\\Desktop\\Gitproj\\front-end\\src\\views\\counseling\\MyReservation.vue","mtime":1576616650505},{"path":"C:\\Users\\Gavin Yu\\Desktop\\Gitproj\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1573722996621},{"path":"C:\\Users\\Gavin Yu\\Desktop\\Gitproj\\front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":1573725483614},{"path":"C:\\Users\\Gavin Yu\\Desktop\\Gitproj\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1573722996621},{"path":"C:\\Users\\Gavin Yu\\Desktop\\Gitproj\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1573725517685}],"contextDependencies":[],"result":["import _toConsumableArray from \"C:\\\\Users\\\\Gavin Yu\\\\Desktop\\\\Gitproj\\\\front-end\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/toConsumableArray\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Fuse from 'fuse.js';\nimport Vue from 'vue';\nimport { getMyReserve, cancelAppointment } from '@/api/counseling';\nimport Lightbox from 'vue-easy-lightbox';\nimport { PageView } from '@/layouts';\nVue.use(Lightbox);\nvar columns = [{\n  title: '预约单号',\n  dataIndex: 'id',\n  //width: '10%',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'id'\n  },\n  sorter: function sorter(a, b) {\n    return a.id > b.id;\n  }\n}, {\n  title: '老师姓名',\n  dataIndex: 'teacherName',\n  //width: '15%',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'teacherName'\n  }\n}, {\n  title: '预约时间',\n  dataIndex: 'reserveTime',\n  align: 'center',\n  width: '18%',\n  scopedSlots: {\n    customRender: 'reserveTime'\n  },\n  sorter: function sorter(a, b) {\n    return a.reserveTime > b.reserveTime;\n  }\n}, {\n  title: '预约地址',\n  dataIndex: 'address',\n  align: 'center',\n  width: '30%',\n  scopedSlots: {\n    customRender: 'address'\n  }\n}, {\n  titile: '操作',\n  align: 'center',\n  dataIndex: 'operation',\n  scopedSlots: {\n    customRender: 'operation'\n  }\n}];\nvar rData = [];\nvar rDataShow = [];\nexport default {\n  name: 'myReservation',\n  inject: ['reload'],\n  components: {\n    PageView: PageView\n  },\n  data: function data() {\n    return {\n      rData: rData,\n      rDataShow: rDataShow,\n      deleteInfo: '',\n      columns: columns,\n      current: 1,\n      totalPage: '',\n      visible2: false,\n      todelete: '',\n      form: this.$form.createForm(this)\n    };\n  },\n  filters: {\n    statusFilter: function statusFilter(type) {\n      return statusMap[type].text;\n    },\n    statusTypeFilter: function statusTypeFilter(type) {\n      return statusMap[type].status;\n    }\n  },\n  methods: {\n    onClickDeleteRow: function onClickDeleteRow() {\n      var _this = this;\n\n      var h = this.$createElement;\n      this.visible2 = false;\n\n      var newData = _toConsumableArray(this.rDataShow);\n\n      console.log(newData);\n      var target = newData.filter(function (item) {\n        return _this.todelete === item.id;\n      })[0];\n      console.log(target);\n      cancelAppointment({\n        id: target.id\n      }).then(function (response) {\n        _this.deleteInfo = response.info;\n\n        if (_this.deleteInfo !== 'fail') {\n          _this.rData = _toConsumableArray(response.data);\n          _this.rDataShow = _this.rData;\n        }\n\n        if (_this.deleteInfo === 'ok') {\n          _this.$notification.open({\n            message: '取消成功',\n            description: '本条预约取消成功',\n            icon: h(\"a-icon\", {\n              \"attrs\": {\n                \"type\": \"check\"\n              },\n              \"style\": \"color: #108ee9\"\n            })\n          });\n        } else {\n          _this.$notification.open({\n            message: '取消失败',\n            description: '本条预约取消失败',\n            icon: h(\"a-icon\", {\n              \"attrs\": {\n                \"type\": \"warning\"\n              },\n              \"style\": \"color: #108ee9\"\n            })\n          });\n        }\n\n        _this.reload();\n      }); // to be complete\n    },\n    onClickRefresh: function onClickRefresh() {\n      this.reload();\n    },\n    onClickDelete: function onClickDelete(id) {\n      console.log(id);\n      this.todelete = id;\n      this.visible2 = true;\n    },\n    onChange: function onChange(current) {\n      var _this2 = this;\n\n      this.current = current;\n      getMyReserve({\n        page: this.current - 1\n      }).then(function (response) {\n        console.log(response);\n        console.log(_this2.page);\n        _this2.rData = response.data;\n        _this2.rDataShow = _this2.rData.reserve;\n        _this2.totalPage = _this2.rData.totalPage;\n      });\n    }\n  },\n  mounted: function mounted() {\n    var _this3 = this;\n\n    console.log(\"my\");\n    getMyReserve({\n      page: this.current - 1\n    }).then(function (response) {\n      console.log(response);\n      console.log(_this3.page);\n      _this3.rData = response.data;\n      _this3.rDataShow = _this3.rData.reserve;\n      _this3.totalPage = _this3.rData.total;\n    });\n  }\n};",{"version":3,"sources":["MyReservation.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <page-view title=\"我的预约\">\n    <a-card>\n      <template>\n        <a-table :columns=\"columns\" :dataSource=\"rDataShow\" rowKey=\"id\" bordered>\n          <template\n              v-for=\"col in ['id', 'teacherName', 'reserveTime', 'address']\"\n              :slot=\"col\"\n              slot-scope=\"text\"\n            >\n            <div :key=\"col\">{{ text }}</div>\n          </template>\n          <template slot=\"operation\" slot-scope=\"text, record\">\n            <a-button\n              size=\"small\"\n              type=\"danger\"\n              :hidden='text'\n              @click=\"onClickDelete(record.id)\"\n            >取消预约\n            </a-button>\n            <a-modal\n              title=\"确认取消\"\n              v-model=\"visible2\"\n              @ok=\"onClickDeleteRow\"\n            >\n              <div class=\"modal\">\n                是否取消本次预约\n              </div>\n            </a-modal>\n          </template>\n        </a-table>\n        <div style=\"margin-top:20px\">\n          <a-pagination @change=\"onChange\" :current=\"current\" :total=\"(totalPage+1)*10\" />\n        </div>\n      </template>\n    </a-card>\n  </page-view>\n</template>\n\n\n<script>\nimport Fuse from 'fuse.js'\nimport Vue from 'vue'\nimport { getMyReserve, cancelAppointment } from '@/api/counseling'\nimport Lightbox from 'vue-easy-lightbox'\nimport { PageView } from '@/layouts'\nVue.use(Lightbox)\n\nconst columns = [\n  {\n    title: '预约单号',\n    dataIndex: 'id',\n    //width: '10%',\n    align: 'center',\n    scopedSlots: { customRender: 'id' },\n    sorter: (a, b) => a.id > b.id,\n  },\n  {\n    title: '老师姓名',\n    dataIndex: 'teacherName',\n   //width: '15%',\n    align: 'center',\n    scopedSlots: { customRender: 'teacherName' },\n  },\n  {\n    title: '预约时间',\n    dataIndex: 'reserveTime',\n    align: 'center',\n    width: '18%',\n    scopedSlots: { customRender: 'reserveTime' },\n    sorter: (a, b) => a.reserveTime > b.reserveTime\n  },\n  {\n    title: '预约地址',\n    dataIndex: 'address',\n    align: 'center',\n    width: '30%',\n    scopedSlots: { customRender: 'address' }\n  },\n  {\n    titile: '操作',\n    align: 'center',\n    dataIndex: 'operation',\n    scopedSlots: { customRender: 'operation' }\n  },\n]\n\nconst rData=[]\nconst rDataShow=[]\n\nexport default {\n  name: 'myReservation',\n  inject: ['reload'],\n  components: {\n    PageView\n  },\n  data() {\n     return {\n        rData,\n        rDataShow,\n        deleteInfo:'',\n        columns,\n        current: 1,\n        totalPage:'',\n        visible2: false,\n        todelete:'',\n        form: this.$form.createForm(this)\n     };\n  },\n  filters: {\n    statusFilter (type) {\n       return statusMap[type].text\n    },\n    statusTypeFilter (type) {\n       return statusMap[type].status\n    }\n  },\n  methods:{\n    onClickDeleteRow () {\n      this.visible2 = false;\n      const newData = [...this.rDataShow]\n      console.log(newData)\n      const target = newData.filter(item => this.todelete === item.id)[0]\n      console.log(target)\n\n      cancelAppointment({ id : target.id}).then((response) => {\n        this.deleteInfo = response.info\n        if(this.deleteInfo !== 'fail'){\n          this.rData = [...response.data]\n          this.rDataShow = this.rData\n        }\n        if(this.deleteInfo === 'ok'){\n          this.$notification.open({\n          message: '取消成功',\n          description: '本条预约取消成功',\n          icon: <a-icon type=\"check\" style=\"color: #108ee9\" />,\n        });\n        }\n        else{\n          this.$notification.open({\n          message: '取消失败',\n          description: '本条预约取消失败',\n          icon: <a-icon type=\"warning\" style=\"color: #108ee9\" />,\n        });\n        }\n        this.reload()\n      })\n      // to be complete\n      },\n      onClickRefresh(){\n        this.reload()\n      },\n      onClickDelete (id) {\n        console.log(id)\n        this.todelete = id\n        this.visible2 = true;\n      },\n      onChange(current){\n        this.current=current;\n        getMyReserve({page:this.current-1}).then((response)=>{\n        console.log(response);\n        console.log(this.page);\n        this.rData=response.data;\n        this.rDataShow=this.rData.reserve;\n        this.totalPage=this.rData.totalPage\n      })\n     }\n    },\n    mounted(){\n      console.log(\"my\")\n      getMyReserve({page:this.current-1}).then((response)=>{\n        console.log(response);\n        console.log(this.page);\n        this.rData=response.data;\n        this.rDataShow=this.rData.reserve;\n        this.totalPage=this.rData.total\n      })\n    }\n  };\n\n</script>\n\n<style lang=\"less\" scoped>\n@import '~ant-design-vue/lib/style/themes/default.less';\n.button-group {\n  margin-bottom: 1rem;\n  .button {\n    margin-left: 0.5rem;\n    margin-left: 0.5rem;\n  }\n}\n</style>\n"],"sourceRoot":"src/views/counseling"}]}